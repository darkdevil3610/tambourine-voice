# Coturn TURN Server Configuration for Tambourine
# ================================================
# Uses HMAC-based time-limited credentials (use-auth-secret mode)

# Listening ports
listening-port=3478
tls-listening-port=5349

# Relay port range
min-port=49152
max-port=65535

# Use fingerprint in TURN messages for better NAT traversal
fingerprint

# Enable long-term credential mechanism with HMAC auth
# Clients generate credentials using: username=expiry_timestamp, password=HMAC(secret, username)
use-auth-secret

# The shared secret is provided via environment variable at runtime
# This allows the same secret to be used for both TURN server validation
# and Tambourine server credential generation
# Set TURN_SHARED_SECRET environment variable
static-auth-secret=${TURN_SHARED_SECRET}

# Server identification (use actual IP/domain in production)
# realm is used in credential generation
realm=tambourine-turn

# Verbose logging for debugging (comment out in production)
verbose

# Log to stdout for Docker
log-file=stdout

# No stale nonce - allows clients to reuse credentials during TTL window
no-stale-nonce

# Don't allow peers on private IP ranges for security
# (prevents TURN server from being used to access internal networks)
no-multicast-peers

# Only allow UDP relay (WebRTC primarily uses UDP for media)
# If TCP relay is needed, remove this line
no-tcp-relay

# Mobility support for mobile clients that switch networks
mobility

# Enable connection status callbacks (optional)
# Useful for monitoring active connections
# cli-ip=127.0.0.1
# cli-port=5766
